{"version":3,"file":"feature-status.js","sources":["../../../src/modules/feature-status/feature-status.ts"],"sourcesContent":["import { Feature, PlanStatus } from '@tps/feature.types'\n\nexport default class FeatureStatus<T> {\n  features: Array<Feature<T>>\n  featureName: string\n  planStatus: PlanStatus\n  suggestion?: string\n  result?: Feature<T>\n  limit?: number\n\n  constructor(data: {\n    features: Array<Feature<T>>\n    featureName: string\n    planStatus: PlanStatus\n    suggestion?: string\n  }) {\n    this.features = data.features\n    this.featureName = data.featureName\n    this.planStatus = data.planStatus\n    this.suggestion = data.suggestion\n    this.result = this.getFeature()\n    this.limit = this.result === undefined ? 42 : this.result.limit\n  }\n\n  getFeature(): Feature<T> | undefined {\n    return this.features.find((feature) => feature.name === this.featureName)\n  }\n\n  isActive(): boolean {\n    if (this.result === undefined) return true\n    else return this.result.isActive\n  }\n\n  isPro(): boolean {\n    if (this.result === undefined) return false\n    else return this.result.isPro\n  }\n\n  isNew(): boolean {\n    if (this.result === undefined) return false\n    else return this.result.isNew\n  }\n\n  isBlocked(): boolean {\n    const match = this.result\n\n    if (match !== undefined)\n      if (match.isPro && this.planStatus === 'PAID') return false\n      else if (!match.isPro && this.planStatus === 'PAID') return false\n      else if (!match.isPro && this.planStatus === 'UNPAID') return false\n      else return true\n    else return true\n  }\n\n  isReached(current: number): boolean {\n    const match = this.result\n\n    if (match !== undefined && match.limit !== undefined) {\n      if (match.isPro)\n        if (this.planStatus === 'UNPAID')\n          return current >= (match.limit as number) ? true : false\n        else return false\n      else return false\n    } else if (match !== undefined && match.limit === undefined) return false\n    else return true\n  }\n\n  isAvailableAndBlocked(): string | null | undefined {\n    if (!this.isBlocked()) return this.suggestion\n    else return null\n  }\n}\n"],"names":["FeatureStatus","data","__publicField","feature","match","current"],"mappings":";;;AAEA,MAAqBA,EAAiB;AAAA,EAQpC,YAAYC,GAKT;AAZH,IAAAC,EAAA;AACA,IAAAA,EAAA;AACA,IAAAA,EAAA;AACA,IAAAA,EAAA;AACA,IAAAA,EAAA;AACA,IAAAA,EAAA;AAQE,SAAK,WAAWD,EAAK,UACrB,KAAK,cAAcA,EAAK,aACxB,KAAK,aAAaA,EAAK,YACvB,KAAK,aAAaA,EAAK,YAClB,KAAA,SAAS,KAAK,WAAW,GAC9B,KAAK,QAAQ,KAAK,WAAW,SAAY,KAAK,KAAK,OAAO;AAAA,EAAA;AAAA,EAG5D,aAAqC;AAC5B,WAAA,KAAK,SAAS,KAAK,CAACE,MAAYA,EAAQ,SAAS,KAAK,WAAW;AAAA,EAAA;AAAA,EAG1E,WAAoB;AACd,WAAA,KAAK,WAAW,SAAkB,KAC1B,KAAK,OAAO;AAAA,EAAA;AAAA,EAG1B,QAAiB;AACX,WAAA,KAAK,WAAW,SAAkB,KAC1B,KAAK,OAAO;AAAA,EAAA;AAAA,EAG1B,QAAiB;AACX,WAAA,KAAK,WAAW,SAAkB,KAC1B,KAAK,OAAO;AAAA,EAAA;AAAA,EAG1B,YAAqB;AACnB,UAAMC,IAAQ,KAAK;AAEnB,WAAIA,MAAU,SACRA,EAAM,SAAS,KAAK,eAAe,UAC9B,CAACA,EAAM,SAAS,KAAK,eAAe,SADS,KAE7C,GAACA,EAAM,SAAS,KAAK,eAAe,YAEnC;AAAA,EAAA;AAAA,EAGd,UAAUC,GAA0B;AAClC,UAAMD,IAAQ,KAAK;AAEnB,WAAIA,MAAU,UAAaA,EAAM,UAAU,SACrCA,EAAM,SACJ,KAAK,eAAe,WACfC,KAAYD,EAAM,QAEjB,KACH,EAAAA,MAAU,UAAaA,EAAM,UAAU;AAAA,EACtC;AAAA,EAGd,wBAAmD;AACjD,WAAK,KAAK,cACE,OADkB,KAAK;AAAA,EACvB;AAEhB;"}